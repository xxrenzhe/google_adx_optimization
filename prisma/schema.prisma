generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model AdReport {
  id                  String     @id @default(cuid())
  sessionId           String
  uploadDate          DateTime   @default(now())
  dataDate            DateTime
  website             String
  country             String?
  adFormat            String?
  adUnit              String?
  advertiser          String?
  domain              String?
  device              String?
  browser             String?
  requests            BigInt?
  impressions         BigInt?
  clicks              BigInt?
  ctr                 Float?
  ecpm                Float?
  revenue             Float?
  viewableImpressions BigInt?
  viewabilityRate     Float?
  measurableImpressions BigInt?
  fillRate            Float?
  arpu                Float?

  @@index([sessionId, id])
  @@index([sessionId, dataDate])
  @@index([dataDate, website])
  @@index([website, country])
}

model UploadSession {
  id            String   @id @default(cuid())
  filename      String
  uploadedAt    DateTime @default(now())
  status        String   @default("uploading") // uploading, completed, failed
  tempTableName String   @unique
  recordCount   Int?
  fileSize      Int?     // 文件大小（字节）
  processedAt   DateTime?
  analyzedAt    DateTime?
  errorMessage  String?
  
  @@map("upload_sessions")
}